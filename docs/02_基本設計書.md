# 基本設計書
YouTube分析バッチシステム

## 1. 全体構成
YouTube Data API → Pythonバッチ → MySQL（Adminerで管理）

## 2. Docker構成

| サービス | イメージ | 役割 |
|---------|---------|------|
| streamlit | python:3.11-slim | Streamlit WebUI |
| app | python:3.11-slim | Pythonバッチ処理 |
| mysql | mysql:8.0 | データベース |
| adminer | adminer:latest | DB管理画面 |

- データベース名: `youtube_analytics`

## 3. ネットワーク・ポート設計

### 3.1 公開ポート
| サービス | ホスト側 | コンテナ側 | 用途 |
|---------|---------|-----------|------|
| streamlit | 8501 | 8501 | Streamlit WebUIアクセス |
| adminer | 8080 | 8080 | DB管理画面アクセス |

### 3.2 内部通信
| サービス | ポート | 用途 |
|---------|--------|------|
| mysql | 3306 | DB接続（コンテナ間のみ、外部非公開） |

### 3.3 ネットワーク
- 専用ブリッジネットワーク `youtube-analytics-network` を使用
- コンテナ間はサービス名で名前解決（例: `mysql:3306`）

## 4. ボリューム設計
| ホスト側 | コンテナ側 | 用途 |
|---------|-----------|------|
| ./data/mysql | /var/lib/mysql | MySQLデータ永続化 |
| ./data/json | /app/data/json | 中間JSON保存 |
| ./logs | /app/logs | ログ出力 |

## 5. 処理フロー
1. データ取得（YouTube Data API）
2. JSON保存（中間ファイル）
3. 感情分析（3モデルアンサンブル + ルールベース）
   - 日本語: christian-phu/bert-finetuned-japanese-sentiment
   - 日本語: kit-nlp/bert-base-japanese-sentiment-irony
   - 多言語: cardiffnlp/twitter-xlm-roberta-base-sentiment
4. 集計
5. MySQL保存
